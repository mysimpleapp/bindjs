(function(){Bind=function(b,c){var f=b.length;if(void 0!==f)for(var a=0;a<f;++a)Bind(b[a],c);else f=b.innerHTML,a=f.replace(/\?{([^}]*)}/g,'<span ?txt="$1"></span>'),a!==f&&(b.innerHTML=a),t(b,[c])};var u=function(b){return void 0===b||null===b?"":String(b)},t=function(b,c){var f=0;if(b.hasAttribute("?for")){var a=b.getAttribute("?for");b.removeAttribute("?for");var f=A(a),d=v(c,f.arr)(),g=f.idx,n=b.parentNode,e=b.nextSibling,h=[];n.removeChild(b);for(var f=-1+d.length,k=0,m=d.length;k<m;++k)h.push({});
z(c,d,h,g,[],b,n,e);Array.observe(d,function(a){for(var f=[],k=0,m=a.length;k<m;++k){var l=a[k],q=l.type,p=l.index;if("splice"==q)var r=l.removed.length,t=l.addedCount;else"update"==q&&(t=r=1);0<r&&(f=f.concat(h.splice(p,r)));for(l=0;l<t;++l)h.splice(p,0,{})}z(c,d,h,g,f,b,n,e)})}else{for(var k=0,m=b.attributes,q=m.length;k<q;++k){var a=m[k],l=a.name,a=a.value;"?if"==l?p(c,a,b,function(a,b){b.style.display=a?null:"none"}):"?txt"==l?(p(c,a,b,function(a,b){b.textContent=u(a)}),b.getAttribute("contenteditable")&&
w(c,b,"input",a,function(a,b,c){b[c]=a.textContent})):"?html"==l?(p(c,a,b,function(a,b){b.innerHTML=u(a)}),b.getAttribute("contenteditable")&&w(c,b,"input",a,function(a,b,c){b[c]=a.innerHTML})):"?val"==l||"?value"==l?(p(c,a,b,function(a,b){a=u(a);b.value!==a&&(b.value=a)}),w(c,b,"input",a,function(a,b,c){b[c]=a.value})):"?on"===l.substring(0,3)?(l=l.substr(1),b[l]=v(c,a)):"?"===l.charAt(0)&&(l=l.substr(1),p(c,a,b,function(a){return function(b,c){c.setAttribute(a,b)}}(l)))}k=0;q=b.children;for(m=q.length;k<
m;++k)a=t(q[k],c),k+=a,m+=a}return f},v=function(b,c){for(var f=x(c),a="",d=0,g=b.length;d<g;++d)a+="var scope"+d+"=b["+d+"]; ";for(var n=d=0,g=f.length;n<g;++n){var e=f[n],h=y(b,e);null!==h&&(h="scope"+h+".",e=e.idx+d,c=c.slice(0,e)+h+c.slice(e),d+=h.length)}-1===c.indexOf(";")&&(c="return "+c);eval(a+"var fun=function(){"+c+"}");return fun},r=function(b,c){c&&(b="c"+(b?"."+b:""));return eval(b)},y=function(b,c){var f=c.head,a;for(a in b)if(f in b[a])return a;return null},p=function(b,c,
f,a){var d=v(b,c);c=x(c);for(var g=0,n=c.length;g<n;++g){var e=c[g],h=y(b,e);null!==h&&(h=r(e.lst,b[h]),e=r(e.att),Object.observe(h,function(b){return function(c){for(var e=0,g=c.length;e<g;++e)if(c[e].name===b){a(d(),f);break}}}(e)))}a(d(),f)},w=function(b,c,f,a,d){a=x(a);if(1===a.length){a=a[0];var g=y(b,a);if(null!==g){var n=r(a.lst,b[g]),e=r(a.att);c.addEventListener(f,function(){d(c,n,e)})}}},B=/[_a-zA-Z]/,C=/[_a-zA-Z0-9]/,x=function(b){for(var c=!1,f=[],a=null,d=[],g=0,n=b.length;g<n;++g){var e=
b[g];c?e==c&&(c=!1):"'"==e||'"'==e?c=e:(null===a&&B.exec(e)&&(a={idxs:[g]},f.push(a)),null===a||C.exec(e)||(a.idxs.push(g),"["==e&&d.push(a),"."!=e&&(a=null)),"]"==e&&(a=d.pop(),a.idxs.push(g+1)))}null!==a&&a.idxs.push(n);c=0;for(n=f.length;c<n;++c)a=f[c],d=a.idxs,g=d.length,a.idx=d[0],a.head=b.substring(d[0],d[1]),e=b.substring(d[g-2],d[g-1]),2==g?e="'"+e+"'":"."==e[0]&&(e="'"+e.slice(1)+"'"),a.att=e,2<g&&(a.lst=b.substring(d[0],d[g-2]));return f},A=function(b){var c;return(c=/(.*) in (.*)/.exec(b))?
{idx:c[1].split(","),arr:c[2]}:{arr:b}},z=function(b,c,f,a,d,g,n,e){for(var h=0,k=d.length;h<k;++h){var m=d[h].dom;m&&n.removeChild(m)}k=f.length;for(h=k-1;0<=h;--h)if(d=f[h],!d.dom){m=h+1>=f.length?e:f[h+1].dom;k=n.insertBefore(g.cloneNode(!0),m);d.dom=k;var q=b;if(a){var l=a.length;if(0<l){var m=a[0],p={};p[m]=0;q=b.slice();q.push(p);d.keyObj=p;d.keyAtt=m}1<l&&(p[a[1]]=c[h])}t(k,q)}b=0;for(k=f.length;b<k;++b)d=f[b],c=d.keyObj,m=d.keyAtt,c&&(c[m]=b)}})();
